{"ast":null,"code":"var _jsxFileName = \"E:\\\\Work-Files\\\\Maxffort\\\\Client-Projects\\\\HSST-Madhi-Consultancy\\\\Code\\\\dev\\\\edu-project\\\\live\\\\edu-app-admin\\\\src\\\\pages\\\\DashboardPage\\\\Exams\\\\ExamDetails\\\\index.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport SimpleLoading from \"../../../../components/loading/SimpleLoading\";\nimport api from \"../../../../api/api\";\nimport { getCredentials } from \"../../../../services/authService\";\nimport ExamDetailsMenu from \"../../../../components/menu/ExamDetailsMenu\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport { Button, Chip, Grid } from \"@material-ui/core\";\nimport Details from \"./Details\";\nimport Instructions from \"./Instructions\";\nimport Questions from \"./Questions\";\nimport { getExam } from \"../../../../actions/examActions\";\nimport ExamMarkList from './ExamMarkList';\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { Switch, Route, Redirect, withRouter, useLocation } from \"react-router-dom\";\nimport MarkList from \"../MarkLIst\";\nimport ExamAssignStudents from \"./ExamAssignStudents\";\nimport EditQuestions from \"./EditQuestions\";\nimport SnackBar from \"components/SnackBar\";\nconst useStyles = makeStyles(theme => ({\n  menuContainer: {\n    display: \" flex\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\"\n  }\n}));\nexport default function ExamDetails(props) {\n  _s();\n\n  const classes = useStyles();\n  const [edit, setEdit] = useState(false);\n  const exam = useSelector(state => state.exam);\n  const {\n    loading,\n    details,\n    instructions,\n    questions,\n    counts\n  } = exam;\n  const [progress, setProgress] = useState(false);\n  const dispatch = useDispatch();\n  const [status, setStatus] = useState();\n  const [update, setUpdate] = useState(true);\n  const [pgs, setPgs] = useState(false);\n  const [open, setOpen] = React.useState(false);\n  const [data, setData] = useState([]);\n\n  const handleClose = () => {\n    setOpen(false);\n  };\n\n  useEffect(() => {\n    dispatch(getExam(props.match.params.id));\n  }, []);\n  useEffect(() => {\n    setStatus(details.status);\n  }, [loading]);\n\n  const disableExam = async id => {\n    try {\n      const {\n        data\n      } = await api.post(\"/admin/toggleExamStatus\", {\n        examId: id\n      }, {\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${getCredentials()}`\n        }\n      }, {\n        timeout: 1000\n      });\n      dispatch(getExam(props.match.params.id)); // setProgress(false)\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  const editExam = async values => {\n    try {\n      const res = await api.post(\"/admin/editExam\", {\n        details: values\n      }, {\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${getCredentials()}`\n        }\n      }, {\n        timeout: 1000\n      });\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  const onEditClicked = () => {\n    setEdit(!edit);\n  };\n\n  const onAssignClicked = () => {\n    props.history.push(\"/app/exams/details/\" + props.match.params.id + \"/assignStudents\");\n  };\n\n  const onDeleteClicked = () => {};\n\n  const onDisableClicked = () => {\n    // setProgress(true)\n    disableExam(props.match.params.id); // dispatch(getExam(props.match.params.id))\n  };\n\n  const onEdit = async (values, mode) => {\n    switch (mode) {\n      case \"details\":\n        editExam(values);\n        dispatch(getExam(props.match.params.id));\n        setEdit(false);\n        break;\n\n      case \"instructions\":\n        setEdit(false);\n        break;\n\n      case \"questions\":\n        setEdit(false);\n        break;\n    }\n  };\n\n  const updateQuestions = () => {\n    setUpdate(true);\n    setOpen(true);\n  };\n\n  const replaceQuestions = () => {\n    setUpdate(false);\n    setOpen(true);\n  };\n\n  const handleSubmit = async () => {\n    console.log(\"ekfbajksnflkn\"); // setProgress(false)\n\n    setPgs(false);\n\n    try {\n      const resp = await api.post(update ? '/admin/insertAdditionalQuestions' : \"/admin/replaceQuestions\", {\n        examId: details.id,\n        questions: data\n      }, {\n        headers: {\n          Authorization: `Bearer ${getCredentials()}`,\n          \"Content-Type\": \"application/json\"\n        }\n      }); // setProgress(true)\n\n      setOpen(false);\n      window.location.reload(false);\n    } catch (error) {\n      // setProgress(true)\n      console.log(error);\n      setPgs(true);\n    }\n  };\n\n  if (loading && !progress) {\n    console.log(\"d\", !!details);\n    return /*#__PURE__*/React.createElement(SimpleLoading, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 12\n      }\n    });\n  } else return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(EditQuestions, {\n    open: open,\n    handleSubmit: handleSubmit,\n    handleClose: handleClose,\n    update: update,\n    data: data,\n    setData: setData,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(SnackBar, {\n    open: pgs,\n    message: update ? \"An error has occured\" : \"An error has occured or exam is on progress. Cannot replace question sheet now !!\",\n    severity: \"error\",\n    setOpen: setPgs,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(Switch, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Route, {\n    path: \"/app/exams/details/:id/marklist\",\n    component: ExamMarkList,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    path: \"/app/exams/details/:id/assignStudents\",\n    component: ExamAssignStudents,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    path: \"/app/exams/details/:id\",\n    render: () => /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.menuContainer,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 19\n      }\n    }), /*#__PURE__*/React.createElement(ExamDetailsMenu, {\n      onEditClicked: onEditClicked,\n      onDeleteClicked: onDeleteClicked,\n      onDisableClicked: onDisableClicked,\n      onAssignClicked: onAssignClicked,\n      onUpdateQuestionsClicked: updateQuestions,\n      onReplaceQuestionsClicked: replaceQuestions,\n      disabled: details.Status === \"active\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 19\n      }\n    }), /*#__PURE__*/React.createElement(Button, {\n      size: \"small\",\n      variant: \"contained\",\n      color: \"primary\",\n      onClick: () => props.history.push(\"/app/exams/details/\" + props.match.params.id + \"/marklist\"),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 19\n      }\n    }, \"Mark list\")), details.Status && /*#__PURE__*/React.createElement(Chip, {\n      size: \"small\",\n      label: details.Status,\n      color: details.Status === \"active\" ? \"primary\" : \"secondary\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 19\n      }\n    }), /*#__PURE__*/React.createElement(Details, {\n      details: details,\n      edit: edit,\n      onEdit: onEdit,\n      counts: counts,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(Instructions, {\n      edit: false,\n      onEdit: onEdit,\n      instructions: instructions,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(Questions, {\n      questions: questions,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 17\n      }\n    })),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 11\n    }\n  })));\n}\n\n_s(ExamDetails, \"nCY9BncL3gbIJK9hlk4IUx4NNWs=\", false, function () {\n  return [useStyles, useSelector, useDispatch];\n});\n\n_c = ExamDetails;\n\nvar _c;\n\n$RefreshReg$(_c, \"ExamDetails\");","map":{"version":3,"sources":["E:/Work-Files/Maxffort/Client-Projects/HSST-Madhi-Consultancy/Code/dev/edu-project/live/edu-app-admin/src/pages/DashboardPage/Exams/ExamDetails/index.js"],"names":["React","useState","useEffect","SimpleLoading","api","getCredentials","ExamDetailsMenu","makeStyles","Button","Chip","Grid","Details","Instructions","Questions","getExam","ExamMarkList","useDispatch","useSelector","Switch","Route","Redirect","withRouter","useLocation","MarkList","ExamAssignStudents","EditQuestions","SnackBar","useStyles","theme","menuContainer","display","alignItems","justifyContent","ExamDetails","props","classes","edit","setEdit","exam","state","loading","details","instructions","questions","counts","progress","setProgress","dispatch","status","setStatus","update","setUpdate","pgs","setPgs","open","setOpen","data","setData","handleClose","match","params","id","disableExam","post","examId","headers","Authorization","timeout","error","console","log","editExam","values","res","onEditClicked","onAssignClicked","history","push","onDeleteClicked","onDisableClicked","onEdit","mode","updateQuestions","replaceQuestions","handleSubmit","resp","window","location","reload","Status"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport SimpleLoading from \"../../../../components/loading/SimpleLoading\";\r\nimport api from \"../../../../api/api\";\r\nimport { getCredentials } from \"../../../../services/authService\";\r\nimport ExamDetailsMenu from \"../../../../components/menu/ExamDetailsMenu\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport { Button, Chip, Grid } from \"@material-ui/core\";\r\nimport Details from \"./Details\";\r\nimport Instructions from \"./Instructions\";\r\nimport Questions from \"./Questions\";\r\nimport { getExam } from \"../../../../actions/examActions\";\r\nimport ExamMarkList from './ExamMarkList'\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport {\r\n  Switch,\r\n  Route,\r\n  Redirect,\r\n  withRouter,\r\n  useLocation,\r\n} from \"react-router-dom\";\r\nimport MarkList from \"../MarkLIst\";\r\nimport ExamAssignStudents from \"./ExamAssignStudents\";\r\nimport EditQuestions from \"./EditQuestions\";\r\nimport SnackBar from \"components/SnackBar\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  menuContainer: {\r\n    display: \" flex\",\r\n    alignItems: \"center\",\r\n    justifyContent: \"space-between\",\r\n  },\r\n}));\r\nexport default function ExamDetails(props) {\r\n  const classes = useStyles();\r\n\r\n  const [edit, setEdit] = useState(false);\r\n  const exam = useSelector((state) => state.exam);\r\n  const { loading, details, instructions, questions,counts } = exam;\r\n  const [progress, setProgress] = useState(false);\r\n  const dispatch = useDispatch();\r\n  const [status, setStatus] = useState();\r\n  const [update, setUpdate] = useState(true)\r\n  const [pgs, setPgs] = useState(false)\r\n  const [open, setOpen] = React.useState(false);\r\n  const [data, setData] = useState([]);\r\n \r\n  const handleClose = () => {\r\n    setOpen(false);\r\n  }\r\n\r\n  useEffect(() => {\r\n    dispatch(getExam(props.match.params.id));\r\n  }, []);\r\n  useEffect(() => {\r\n    setStatus(details.status);\r\n  }, [loading]);\r\n  const disableExam = async (id) => {\r\n    try {\r\n      const { data } = await api.post(\r\n        \"/admin/toggleExamStatus\",\r\n        { examId: id },\r\n        {\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            Authorization: `Bearer ${getCredentials()}`,\r\n          },\r\n        },\r\n        { timeout: 1000 }\r\n      );\r\n      dispatch(getExam(props.match.params.id));\r\n      // setProgress(false)\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  };\r\n  const editExam = async (values) => {\r\n    try {\r\n      const res = await api.post(\r\n        \"/admin/editExam\",\r\n        { details:values},\r\n        {\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            Authorization: `Bearer ${getCredentials()}`,\r\n          },\r\n        },\r\n        { timeout: 1000 }\r\n      );\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  };\r\n  const onEditClicked = () => {\r\n    setEdit(!edit);\r\n  };\r\n\r\n  const onAssignClicked = () => {\r\n    props.history.push(\"/app/exams/details/\" + props.match.params.id + \"/assignStudents\");\r\n  }\r\n  const onDeleteClicked = () => { };\r\n  const onDisableClicked = () => {\r\n    // setProgress(true)\r\n    disableExam(props.match.params.id);\r\n    // dispatch(getExam(props.match.params.id))\r\n  };\r\n  const onEdit = async (values, mode) => {\r\n    switch (mode) {\r\n      case \"details\":\r\n        editExam(values);\r\n        dispatch(getExam(props.match.params.id));\r\n        setEdit(false);\r\n        break;\r\n\r\n      case \"instructions\":\r\n        setEdit(false);\r\n        break;\r\n\r\n      case \"questions\":\r\n        setEdit(false);\r\n        break;\r\n    }\r\n  };\r\n  const updateQuestions = () => {\r\n    setUpdate(true)\r\n    setOpen(true)\r\n  }\r\n  const replaceQuestions = () => {\r\n    setUpdate(false)\r\n    setOpen(true)\r\n  }\r\n  const handleSubmit =async () => {\r\n    console.log(\"ekfbajksnflkn\")\r\n    // setProgress(false)\r\n    setPgs(false)\r\n    try {\r\n      const resp = await api.post(update?'/admin/insertAdditionalQuestions':\"/admin/replaceQuestions\", { examId:details.id,questions:data },\r\n      {\r\n        headers: {\r\n          Authorization: `Bearer ${getCredentials()}`,\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n      }\r\n      );\r\n      // setProgress(true)\r\n      setOpen(false)\r\n      window.location.reload(false);\r\n      \r\n\r\n    } catch (error) {\r\n      // setProgress(true)\r\n      console.log(error)\r\n      setPgs(true)\r\n\r\n\r\n    }\r\n  };\r\n\r\n  if (loading && !progress) {\r\n    console.log(\"d\", !!details);\r\n    return <SimpleLoading />;\r\n  } else\r\n    return (\r\n      <div>\r\n        <EditQuestions open={open} handleSubmit={handleSubmit} handleClose={handleClose} update={update} data={data} setData={setData}/>\r\n        <SnackBar open={pgs} message={update?\"An error has occured\":\"An error has occured or exam is on progress. Cannot replace question sheet now !!\"} severity=\"error\" setOpen={setPgs} />\r\n        <Switch>\r\n          <Route path=\"/app/exams/details/:id/marklist\" component={ExamMarkList} />\r\n          <Route path=\"/app/exams/details/:id/assignStudents\" component={ExamAssignStudents} />\r\n          <Route\r\n            path=\"/app/exams/details/:id\"\r\n            render={() => (\r\n              <div>\r\n                <div className={classes.menuContainer}>\r\n                  <div></div>\r\n                  <ExamDetailsMenu\r\n                    onEditClicked={onEditClicked}\r\n                    onDeleteClicked={onDeleteClicked}\r\n                    onDisableClicked={onDisableClicked}\r\n                    onAssignClicked={onAssignClicked}\r\n                    onUpdateQuestionsClicked={updateQuestions}\r\n                    onReplaceQuestionsClicked={replaceQuestions}\r\n                    disabled={details.Status === \"active\"}\r\n                  />\r\n                  <Button\r\n                    size=\"small\"\r\n                    variant=\"contained\"\r\n                    color=\"primary\"\r\n                    onClick={() =>\r\n                      props.history.push(\"/app/exams/details/\" + props.match.params.id + \"/marklist\")\r\n                    }\r\n                  >\r\n                    Mark list\r\n          </Button>\r\n                </div>\r\n                {details.Status && (\r\n                  <Chip\r\n                    size=\"small\"\r\n                    label={details.Status}\r\n                    color={\r\n                      details.Status === \"active\" ? \"primary\" : \"secondary\"\r\n                    }\r\n                  />\r\n                )}\r\n                <Details details={details} edit={edit} onEdit={onEdit} counts={counts} />\r\n                <Instructions\r\n                  edit={false}\r\n                  onEdit={onEdit}\r\n                  instructions={instructions}\r\n                />\r\n                <Questions questions={questions} />\r\n              </div>\r\n            )}\r\n          />\r\n        </Switch>\r\n      </div>\r\n    );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}